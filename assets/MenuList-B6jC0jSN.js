import{r as a}from"./index-BP8_t0zE.js";import"./react-is.production.min-DUDD-a5e.js";import{j}from"./extends-BZziWbxp.js";import{b as T}from"./useTimeout-BN_3i7zA.js";import{g as A}from"./getScrollbarSize-Bqq2hMjQ.js";import{o as C}from"./ownerDocument-DW-IO8s5.js";import{u as P}from"./useForkRef-rM2yqL0Y.js";import{L as z}from"./List-DXUuoEiS.js";function k(s,t,r){return s===t?s.firstChild:t&&t.nextElementSibling?t.nextElementSibling:r?null:s.firstChild}function D(s,t,r){return s===t?r?s.firstChild:s.lastChild:t&&t.previousElementSibling?t.previousElementSibling:r?null:s.lastChild}function S(s,t){if(t===void 0)return!0;let r=s.innerText;return r===void 0&&(r=s.textContent),r=r.trim().toLowerCase(),r.length===0?!1:t.repeating?r[0]===t.keys[0]:r.startsWith(t.keys.join(""))}function h(s,t,r,b,d,w){let c=!1,u=d(s,t,t?r:!1);for(;u;){if(u===s.firstChild){if(c)return!1;c=!0}const p=b?!1:u.disabled||u.getAttribute("aria-disabled")==="true";if(!u.hasAttribute("tabindex")||!S(u,w)||p)u=d(s,u,r);else return u.focus(),!0}return!1}const G=a.forwardRef(function(t,r){const{actions:b,autoFocus:d=!1,autoFocusItem:w=!1,children:c,className:u,disabledItemsFocusable:p=!1,disableListWrap:g=!1,onKeyDown:y,variant:E="selectedMenu",...I}=t,f=a.useRef(null),v=a.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});T(()=>{d&&f.current.focus()},[d]),a.useImperativeHandle(b,()=>({adjustStyleForScrollbar:(e,{direction:i})=>{const l=!f.current.style.width;if(e.clientHeight<f.current.clientHeight&&l){const x=`${A(C(e))}px`;f.current.style[i==="rtl"?"paddingLeft":"paddingRight"]=x,f.current.style.width=`calc(100% + ${x})`}return f.current}}),[]);const R=e=>{const i=f.current,l=e.key;if(e.ctrlKey||e.metaKey||e.altKey){y&&y(e);return}const m=C(i).activeElement;if(l==="ArrowDown")e.preventDefault(),h(i,m,g,p,k);else if(l==="ArrowUp")e.preventDefault(),h(i,m,g,p,D);else if(l==="Home")e.preventDefault(),h(i,null,g,p,k);else if(l==="End")e.preventDefault(),h(i,null,g,p,D);else if(l.length===1){const n=v.current,K=l.toLowerCase(),M=performance.now();n.keys.length>0&&(M-n.lastTime>500?(n.keys=[],n.repeating=!0,n.previousKeyMatched=!0):n.repeating&&K!==n.keys[0]&&(n.repeating=!1)),n.lastTime=M,n.keys.push(K);const H=m&&!n.repeating&&S(m,n);n.previousKeyMatched&&(H||h(i,m,!1,p,k,n))?e.preventDefault():n.previousKeyMatched=!1}y&&y(e)},F=P(f,r);let o=-1;a.Children.forEach(c,(e,i)=>{if(!a.isValidElement(e)){o===i&&(o+=1,o>=c.length&&(o=-1));return}e.props.disabled||(E==="selectedMenu"&&e.props.selected||o===-1)&&(o=i),o===i&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(o+=1,o>=c.length&&(o=-1))});const L=a.Children.map(c,(e,i)=>{if(i===o){const l={};return w&&(l.autoFocus=!0),e.props.tabIndex===void 0&&E==="selectedMenu"&&(l.tabIndex=0),a.cloneElement(e,l)}return e});return j.jsx(z,{role:"menu",ref:F,className:u,onKeyDown:R,tabIndex:d?0:-1,...I,children:L})});export{G as M};
